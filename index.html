<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>化学实验小游戏 - 酸碱中和与鲁米诺发光</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #1a2a6c, #2c003e, #1a2a6c);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        color: white;
        overflow-x: hidden;
      }

      .header {
        text-align: center;
        margin-bottom: 20px;
        width: 100%;
        max-width: 1000px;
        background: rgba(0, 0, 0, 0.6);
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        position: relative;
        overflow: hidden;
        border: 2px solid rgba(255, 255, 255, 0.1);
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 Q50,20 100,0 L100,100 Q50,80 0,100 Z" fill="rgba(255,255,255,0.05)"/></svg>');
        background-size: cover;
        z-index: -1;
      }

      h1 {
        font-size: 2.8rem;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        background: linear-gradient(to right, #4facfe, #00f2fe);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        position: relative;
        display: inline-block;
      }

      h1::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 100%;
        height: 3px;
        background: linear-gradient(to right, #4facfe, #00f2fe);
        border-radius: 3px;
      }

      .subtitle {
        font-size: 1.3rem;
        margin-bottom: 15px;
        color: #e0e0e0;
        max-width: 700px;
        margin: 15px auto;
        line-height: 1.6;
      }

      /* 实验选择器 */
      .experiment-selector {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 15px 0 25px;
        flex-wrap: wrap;
      }

      .experiment-btn {
        padding: 12px 30px;
        border: none;
        border-radius: 50px;
        background: linear-gradient(to right, #6a11cb, #2575fc);
        color: white;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        font-size: 1.1rem;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .experiment-btn.active {
        background: linear-gradient(to right, #00f2fe, #4facfe);
        box-shadow: 0 0 20px rgba(0, 242, 254, 0.5);
        transform: translateY(-3px);
      }

      .experiment-btn:hover:not(.active) {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      }

      .game-container {
        display: flex;
        flex-direction: column;
        max-width: 1000px;
        width: 100%;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.5);
        border: 2px solid rgba(255, 255, 255, 0.1);
      }

      .lab-bench {
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect x="0" y="0" width="100" height="100" fill="%232c3e50"/><rect x="0" y="95" width="100" height="5" fill="%231a1a1a"/></svg>');
        background-size: 100px 100px;
        height: 350px;
        position: relative;
        display: flex;
        justify-content: space-around;
        align-items: flex-end;
        padding: 30px;
      }

      .reagent-container {
        display: flex;
        justify-content: space-around;
        padding: 25px;
        background: rgba(30, 30, 40, 0.8);
        border-bottom: 2px solid #4facfe;
        flex-wrap: wrap;
        gap: 15px;
      }

      .reagent {
        width: 100px;
        height: 150px;
        cursor: pointer;
        position: relative;
        transition: transform 0.3s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        perspective: 500px;
      }

      .reagent:hover {
        transform: translateY(-10px);
      }

      .reagent .bottle {
        width: 60px;
        height: 120px;
        border-radius: 5px 5px 15px 15px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        transform-style: preserve-3d;
        transform: rotateX(-5deg);
      }

      .reagent .bottle::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 20px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 5px 5px 0 0;
      }

      .reagent .label {
        background: white;
        color: #333;
        font-weight: bold;
        padding: 4px 8px;
        border-radius: 3px;
        font-size: 0.9rem;
        margin-top: 10px;
        text-align: center;
        width: 100px;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
      }

      .beaker {
        width: 140px;
        height: 180px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 5px 5px 30px 30px;
        position: relative;
        overflow: hidden;
        border: 3px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        transition: transform 0.3s ease;
      }

      .beaker:hover {
        transform: scale(1.03);
      }

      .liquid {
        width: 100%;
        height: 0%;
        transition: height 0.8s ease, background 1.5s ease;
      }

      .bubbles {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }

      .bubble {
        position: absolute;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 50%;
        animation: bubble-rise linear forwards;
        box-shadow: 0 0 5px rgba(255, 255, 255, 0.7);
      }

      @keyframes bubble-rise {
        0% {
          transform: translateY(0) scale(0.5);
          opacity: 1;
        }
        100% {
          transform: translateY(-150px) scale(1.2);
          opacity: 0;
        }
      }

      /* 鲁米诺发光效果 */
      .glow-effect {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border-radius: 5px 5px 30px 30px;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.5s ease;
        box-shadow: 0 0 30px #00f2fe, 0 0 60px #4facfe;
        background: rgba(79, 172, 254, 0.2);
      }

      .controls {
        padding: 25px;
        display: flex;
        flex-direction: column;
        gap: 20px;
        background: rgba(20, 20, 30, 0.8);
      }

      .ph-indicator {
        display: flex;
        height: 35px;
        background: linear-gradient(
          to right,
          #ff0000,
          #ff9900,
          #ffff00,
          #00ff00,
          #00ffff,
          #0000ff,
          #6600cc
        );
        border-radius: 20px;
        overflow: hidden;
        position: relative;
        margin-bottom: 15px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3) inset;
        border: 2px solid rgba(255, 255, 255, 0.2);
      }

      .ph-value {
        position: absolute;
        height: 45px;
        width: 5px;
        background: white;
        top: -5px;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        transition: left 1.5s ease;
        z-index: 10;
      }

      .ph-labels {
        display: flex;
        justify-content: space-between;
        width: 100%;
        padding: 0 5px;
        position: absolute;
        top: 40px;
        font-size: 0.8rem;
        font-weight: bold;
      }

      .control-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        justify-content: center;
      }

      button {
        padding: 12px 25px;
        border: none;
        border-radius: 50px;
        background: linear-gradient(to right, #4facfe, #00f2fe);
        color: white;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 1rem;
      }

      button:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        background: linear-gradient(to right, #00f2fe, #4facfe);
      }

      button:active {
        transform: translateY(1px);
      }

      .instructions {
        background: rgba(0, 0, 0, 0.5);
        padding: 25px;
        border-radius: 15px;
        margin-top: 25px;
        max-width: 1000px;
        width: 100%;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .instructions h2 {
        color: #4facfe;
        margin-bottom: 20px;
        font-size: 1.8rem;
        text-align: center;
      }

      .instructions-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
      }

      .instruction-card {
        background: rgba(30, 30, 50, 0.6);
        padding: 20px;
        border-radius: 10px;
        border-left: 4px solid #4facfe;
      }

      .instruction-card h3 {
        color: #00f2fe;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .instructions ul {
        padding-left: 20px;
      }

      .instructions li {
        margin-bottom: 10px;
        line-height: 1.6;
      }

      .reaction-result {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.8);
        padding: 20px 30px;
        border-radius: 15px;
        font-size: 1.6rem;
        font-weight: bold;
        color: white;
        text-align: center;
        opacity: 0;
        transition: opacity 0.5s ease;
        pointer-events: none;
        border: 2px solid #00f2fe;
        box-shadow: 0 0 20px rgba(0, 242, 254, 0.5);
        z-index: 100;
        max-width: 90%;
      }

      .beaker-label {
        position: absolute;
        bottom: -30px;
        left: 0;
        width: 100%;
        text-align: center;
        font-weight: bold;
        color: white;
        font-size: 1.1rem;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      }

      .info-panel {
        display: flex;
        justify-content: space-between;
        background: rgba(30, 30, 40, 0.8);
        padding: 15px 25px;
        border-bottom: 2px solid #00f2fe;
        flex-wrap: wrap;
        gap: 15px;
      }

      .info-item {
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .info-value {
        font-weight: bold;
        color: #4facfe;
      }

      .share-section {
        margin-top: 20px;
        background: rgba(0, 0, 0, 0.5);
        padding: 20px;
        border-radius: 15px;
        max-width: 1000px;
        width: 100%;
        text-align: center;
      }

      .share-section h3 {
        margin-bottom: 15px;
        color: #4facfe;
      }

      .share-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
      }

      .share-btn {
        padding: 10px 20px;
        border-radius: 50px;
        background: linear-gradient(to right, #4facfe, #00f2fe);
        color: white;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .share-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      @media (max-width: 768px) {
        h1 {
          font-size: 2.2rem;
        }

        .reagent {
          width: 80px;
          height: 130px;
        }

        .reagent .bottle {
          width: 50px;
          height: 100px;
        }

        .reagent .label {
          width: 80px;
          font-size: 0.8rem;
        }

        .beaker {
          width: 110px;
          height: 150px;
        }

        .lab-bench {
          height: 300px;
          padding: 20px;
        }

        button {
          padding: 10px 15px;
          font-size: 0.9rem;
        }
      }

      @media (max-width: 480px) {
        h1 {
          font-size: 1.8rem;
        }

        .subtitle {
          font-size: 1.1rem;
        }

        .reagent {
          width: 70px;
          height: 120px;
        }

        .reagent .bottle {
          width: 40px;
          height: 80px;
        }

        .reagent .label {
          width: 70px;
          font-size: 0.7rem;
          padding: 3px 5px;
        }

        .beaker {
          width: 90px;
          height: 130px;
        }

        .control-buttons {
          gap: 10px;
        }

        button {
          padding: 8px 12px;
          font-size: 0.8rem;
        }
      }

      .flask-icon {
        font-size: 1.2rem;
        animation: float 3s ease-in-out infinite;
      }

      @keyframes float {
        0% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
        100% {
          transform: translateY(0);
        }
      }

      .luminol-glow {
        animation: glow-pulse 2s infinite alternate;
      }

      @keyframes glow-pulse {
        0% {
          box-shadow: 0 0 5px rgba(79, 172, 254, 0.5),
            0 0 10px rgba(79, 172, 254, 0.4);
        }
        100% {
          box-shadow: 0 0 20px rgba(79, 172, 254, 0.8),
            0 0 40px rgba(79, 172, 254, 0.6);
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1><i class="fas fa-flask flask-icon"></i> 化学实验小游戏</h1>
      <p class="subtitle">酸碱中和与鲁米诺发光实验 - 探索化学反应的奇妙世界</p>

      <div class="experiment-selector">
        <button class="experiment-btn active" id="acid-base-btn">
          <i class="fas fa-vial"></i> 酸碱中和实验
        </button>
        <button class="experiment-btn" id="luminol-btn">
          <i class="fas fa-lightbulb"></i> 鲁米诺发光实验
        </button>
      </div>
    </div>

    <!-- 酸碱中和实验容器 -->
    <div class="game-container" id="acid-base-experiment">
      <div class="info-panel">
        <div class="info-item">
          <i class="fas fa-vial"></i> 实验状态:
          <span class="info-value" id="status">准备中</span>
        </div>
        <div class="info-item">
          <i class="fas fa-flask"></i> 混合液体:
          <span class="info-value" id="mixture">无</span>
        </div>
        <div class="info-item">
          <i class="fas fa-weight-hanging"></i> 当前体积:
          <span class="info-value" id="volume">0ml</span>
        </div>
        <div class="info-item">
          <i class="fas fa-thermometer-half"></i> 当前温度:
          <span class="info-value" id="temperature">25°C</span>
        </div>
      </div>

      <div class="reagent-container">
        <div class="reagent" id="acid">
          <div class="bottle">
            <div
              class="liquid"
              style="
                height: 100%;
                background: linear-gradient(to top, #ff0000, #ff5252);
              "
            ></div>
          </div>
          <div class="label">盐酸 (HCl)</div>
        </div>

        <div class="reagent" id="base">
          <div class="bottle">
            <div
              class="liquid"
              style="
                height: 100%;
                background: linear-gradient(to top, #0000ff, #5252ff);
              "
            ></div>
          </div>
          <div class="label">氢氧化钠 (NaOH)</div>
        </div>

        <div class="reagent" id="phenolphthalein">
          <div class="bottle">
            <div
              class="liquid"
              style="
                height: 100%;
                background: linear-gradient(to top, #ffffff, #f0f0f0);
              "
            ></div>
          </div>
          <div class="label">酚酞指示剂</div>
        </div>

        <div class="reagent" id="water">
          <div class="bottle">
            <div
              class="liquid"
              style="
                height: 100%;
                background: linear-gradient(to top, #00aaff, #66ccff);
              "
            ></div>
          </div>
          <div class="label">蒸馏水</div>
        </div>
      </div>

      <div class="lab-bench">
        <div class="beaker" id="beaker">
          <div class="liquid" id="beaker-liquid"></div>
          <div class="bubbles" id="bubbles"></div>
          <div class="beaker-label">反应烧杯</div>
        </div>

        <div class="reaction-result" id="reaction-result">中和反应完成！</div>
      </div>

      <div class="controls">
        <div class="ph-indicator">
          <div class="ph-value" id="ph-indicator"></div>
          <div class="ph-labels">
            <span>0</span>
            <span>2</span>
            <span>4</span>
            <span>6</span>
            <span>8</span>
            <span>10</span>
            <span>12</span>
            <span>14</span>
          </div>
        </div>
        <div class="control-buttons">
          <button id="start-btn"><i class="fas fa-play"></i> 开始实验</button>
          <button id="add-acid">
            <i class="fas fa-tint" style="color: #ff5252"></i> 添加盐酸
          </button>
          <button id="add-base">
            <i class="fas fa-tint" style="color: #5252ff"></i> 添加氢氧化钠
          </button>
          <button id="add-indicator">
            <i class="fas fa-tint" style="color: #f0f0f0"></i> 添加酚酞
          </button>
          <button id="add-water">
            <i class="fas fa-tint" style="color: #66ccff"></i> 添加水
          </button>
          <button id="reset-btn"><i class="fas fa-redo"></i> 重置实验</button>
        </div>
      </div>
    </div>

    <!-- 鲁米诺实验容器 -->
    <div class="game-container" id="luminol-experiment" style="display: none">
      <div class="info-panel">
        <div class="info-item">
          <i class="fas fa-vial"></i> 实验状态:
          <span class="info-value" id="luminol-status">准备中</span>
        </div>
        <div class="info-item">
          <i class="fas fa-flask"></i> 混合液体:
          <span class="info-value" id="luminol-mixture">无</span>
        </div>
        <div class="info-item">
          <i class="fas fa-weight-hanging"></i> 当前体积:
          <span class="info-value" id="luminol-volume">0ml</span>
        </div>
        <div class="info-item">
          <i class="fas fa-bolt"></i> 发光强度:
          <span class="info-value" id="glow-intensity">0%</span>
        </div>
      </div>

      <div class="reagent-container">
        <div class="reagent" id="luminol-solution">
          <div class="bottle">
            <div
              class="liquid"
              style="
                height: 100%;
                background: linear-gradient(to top, #ffff00, #ffee00);
              "
            ></div>
          </div>
          <div class="label">鲁米诺溶液</div>
        </div>

        <div class="reagent" id="hydrogen-peroxide">
          <div class="bottle">
            <div
              class="liquid"
              style="
                height: 100%;
                background: linear-gradient(to top, #ffffff, #f0f0f0);
              "
            ></div>
          </div>
          <div class="label">过氧化氢</div>
        </div>

        <div class="reagent" id="catalyst">
          <div class="bottle">
            <div
              class="liquid"
              style="
                height: 100%;
                background: linear-gradient(to top, #ff6600, #ff9900);
              "
            ></div>
          </div>
          <div class="label">催化剂</div>
        </div>

        <div class="reagent" id="luminol-water">
          <div class="bottle">
            <div
              class="liquid"
              style="
                height: 100%;
                background: linear-gradient(to top, #00aaff, #66ccff);
              "
            ></div>
          </div>
          <div class="label">蒸馏水</div>
        </div>
      </div>

      <div class="lab-bench">
        <div class="beaker luminol-glow" id="luminol-beaker">
          <div class="liquid" id="luminol-liquid"></div>
          <div class="bubbles" id="luminol-bubbles"></div>
          <div class="glow-effect" id="glow-effect"></div>
          <div class="beaker-label">反应烧杯</div>
        </div>

        <div class="reaction-result" id="luminol-result">发光反应开始！</div>
      </div>

      <div class="controls">
        <div class="control-buttons">
          <button id="luminol-start-btn">
            <i class="fas fa-play"></i> 开始实验
          </button>
          <button id="add-luminol">
            <i class="fas fa-tint" style="color: #ffee00"></i> 添加鲁米诺
          </button>
          <button id="add-peroxide">
            <i class="fas fa-tint" style="color: #f0f0f0"></i> 添加过氧化氢
          </button>
          <button id="add-catalyst">
            <i class="fas fa-tint" style="color: #ff9900"></i> 添加催化剂
          </button>
          <button id="add-luminol-water">
            <i class="fas fa-tint" style="color: #66ccff"></i> 添加水
          </button>
          <button id="luminol-reset-btn">
            <i class="fas fa-redo"></i> 重置实验
          </button>
        </div>
      </div>
    </div>

    <div class="instructions">
      <h2><i class="fas fa-book"></i> 实验说明</h2>
      <div class="instructions-content">
        <div class="instruction-card">
          <h3><i class="fas fa-vial"></i> 酸碱中和实验</h3>
          <p>
            酸和碱混合时发生中和反应，生成盐和水。酚酞指示剂在碱性溶液中变粉红色。
          </p>
          <ul>
            <li>盐酸 + 氢氧化钠 → 氯化钠 + 水</li>
            <li>反应放热，温度升高</li>
            <li>当酸和碱等量时达到中和点</li>
          </ul>
        </div>

        <div class="instruction-card">
          <h3><i class="fas fa-lightbulb"></i> 鲁米诺发光实验</h3>
          <p>鲁米诺在氧化剂和催化剂存在下发生化学反应，产生蓝光。</p>
          <ul>
            <li>鲁米诺 + 过氧化氢 → 激发态产物 → 基态 + 光</li>
            <li>常用催化剂：铁氰化钾、过氧化氢酶</li>
            <li>法医学中用于检测血迹</li>
          </ul>
        </div>

        <div class="instruction-card">
          <h3><i class="fas fa-list-ol"></i> 操作步骤</h3>
          <ol>
            <li>从上方选择要进行的实验</li>
            <li>点击"开始实验"按钮</li>
            <li>添加试剂到烧杯中</li>
            <li>观察反应现象</li>
            <li>使用"重置实验"重新开始</li>
          </ol>
        </div>

        <div class="instruction-card">
          <h3><i class="fas fa-exclamation-triangle"></i> 安全提示</h3>
          <ul>
            <li>在真实实验中操作化学品时需佩戴防护装备</li>
            <li>鲁米诺实验应在黑暗环境中观察效果</li>
            <li>实验应在专业指导下进行</li>
            <li>切勿随意混合未知化学品</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="share-section">
      <h3><i class="fas fa-share-alt"></i> 分享这个实验</h3>
      <div class="share-buttons">
        <a href="#" class="share-btn" id="copy-link"
          ><i class="fas fa-link"></i> 复制链接</a
        >
        <a
          href="https://twitter.com/intent/tweet?text=来试试这个有趣的化学实验小游戏！&url="
          class="share-btn"
          target="_blank"
          ><i class="fab fa-twitter"></i> Twitter</a
        >
        <a
          href="https://www.facebook.com/sharer/sharer.php?u="
          class="share-btn"
          target="_blank"
          ><i class="fab fa-facebook"></i> Facebook</a
        >
      </div>
    </div>

    <script>
      // 实验状态变量
      let currentExperiment = "acid-base";
      let acidAmount = 0;
      let baseAmount = 0;
      let waterAmount = 0;
      let indicatorAdded = false;
      let experimentStarted = false;
      let reactionOccurring = false;
      let temperature = 25;

      // 鲁米诺实验变量
      let luminolAmount = 0;
      let peroxideAmount = 0;
      let catalystAdded = false;
      let waterLuminolAmount = 0;
      let glowIntensity = 0;
      let glowTimer = null;

      // DOM元素引用
      const acidBaseExperiment = document.getElementById(
        "acid-base-experiment"
      );
      const luminolExperiment = document.getElementById("luminol-experiment");
      const acidBaseBtn = document.getElementById("acid-base-btn");
      const luminolBtn = document.getElementById("luminol-btn");

      // 实验选择器事件
      acidBaseBtn.addEventListener("click", () =>
        switchExperiment("acid-base")
      );
      luminolBtn.addEventListener("click", () => switchExperiment("luminol"));

      // 切换实验
      function switchExperiment(experiment) {
        currentExperiment = experiment;

        if (experiment === "acid-base") {
          acidBaseExperiment.style.display = "flex";
          luminolExperiment.style.display = "none";
          acidBaseBtn.classList.add("active");
          luminolBtn.classList.remove("active");
        } else {
          acidBaseExperiment.style.display = "none";
          luminolExperiment.style.display = "flex";
          luminolBtn.classList.add("active");
          acidBaseBtn.classList.remove("active");
        }
      }

      // 酸碱中和实验逻辑
      {
        // DOM元素引用
        const beakerLiquid = document.getElementById("beaker-liquid");
        const bubblesContainer = document.getElementById("bubbles");
        const phIndicator = document.getElementById("ph-indicator");
        const reactionResult = document.getElementById("reaction-result");
        const statusDisplay = document.getElementById("status");
        const mixtureDisplay = document.getElementById("mixture");
        const volumeDisplay = document.getElementById("volume");
        const temperatureDisplay = document.getElementById("temperature");

        // 试剂按钮
        document
          .getElementById("start-btn")
          .addEventListener("click", startExperiment);
        document
          .getElementById("add-acid")
          .addEventListener("click", () => addReagent("acid"));
        document
          .getElementById("add-base")
          .addEventListener("click", () => addReagent("base"));
        document
          .getElementById("add-indicator")
          .addEventListener("click", addIndicator);
        document
          .getElementById("add-water")
          .addEventListener("click", () => addReagent("water"));
        document
          .getElementById("reset-btn")
          .addEventListener("click", resetExperiment);

        // 开始实验
        function startExperiment() {
          if (!experimentStarted) {
            experimentStarted = true;
            statusDisplay.textContent = "实验中";
            document.getElementById("start-btn").innerHTML =
              '<i class="fas fa-flask"></i> 实验中';
            document.getElementById("start-btn").style.background =
              "linear-gradient(to right, #00c853, #64dd17)";

            // 显示提示信息
            showReactionResult("实验已开始！请添加试剂进行实验");
          }
        }

        // 添加试剂
        function addReagent(type) {
          if (!experimentStarted) {
            showReactionResult("请先点击'开始实验'按钮！");
            return;
          }

          if (reactionOccurring) return;

          // 更新液体量
          if (type === "acid") acidAmount += 10;
          if (type === "base") baseAmount += 10;
          if (type === "water") waterAmount += 10;

          // 更新显示
          updateBeaker();
          updateMixtureDisplay();

          // 检查反应
          if (acidAmount > 0 && baseAmount > 0) {
            startReaction();
          }
        }

        // 添加指示剂
        function addIndicator() {
          if (!experimentStarted) {
            showReactionResult("请先点击'开始实验'按钮！");
            return;
          }

          indicatorAdded = true;
          updateBeaker();
          updateMixtureDisplay();
          showReactionResult("已添加酚酞指示剂！在碱性溶液中会变成粉红色");
        }

        // 更新烧杯显示
        function updateBeaker() {
          const totalVolume = acidAmount + baseAmount + waterAmount;
          const liquidHeight = Math.min(100, totalVolume * 0.6);

          // 设置烧杯液体高度
          beakerLiquid.style.height = `${liquidHeight}%`;
          volumeDisplay.textContent = `${totalVolume}ml`;

          // 根据pH值设置颜色
          const phValue = calculatePh();
          updatePhIndicator(phValue);

          // 设置液体颜色
          let liquidColor;
          if (totalVolume === 0) {
            liquidColor = "transparent";
          } else if (indicatorAdded) {
            // 酚酞存在时颜色变化
            if (phValue < 8.2) {
              liquidColor = "#ff5252"; // 酸性 - 红色
            } else {
              liquidColor = "#ff66cc"; // 碱性 - 粉色
            }
          } else {
            // 没有酚酞时根据酸碱性显示
            if (acidAmount > baseAmount) {
              liquidColor = "#ff5252"; // 酸性 - 红色
            } else if (baseAmount > acidAmount) {
              liquidColor = "#5252ff"; // 碱性 - 蓝色
            } else {
              liquidColor = "#f0f0f0"; // 中性 - 白色
            }
          }

          // 添加水会稀释颜色
          const dilution = Math.min(1, waterAmount / (totalVolume || 1));
          const dilutedColor = diluteColor(liquidColor, dilution);

          beakerLiquid.style.background = `linear-gradient(to top, ${dilutedColor}, ${lightenColor(
            dilutedColor
          )})`;

          // 更新温度
          updateTemperature();
        }

        // 计算pH值
        function calculatePh() {
          const totalVolume = acidAmount + baseAmount + waterAmount;
          if (totalVolume === 0) return 7;

          // 计算酸和碱的比例
          const acidRatio = acidAmount / totalVolume;
          const baseRatio = baseAmount / totalVolume;

          // 计算pH值（简化模型）
          if (acidRatio > baseRatio) {
            return 1 + (acidRatio - baseRatio) * 6;
          } else if (baseRatio > acidRatio) {
            return 13 - (baseRatio - acidRatio) * 6;
          } else {
            return 7;
          }
        }

        // 更新pH指示器
        function updatePhIndicator(phValue) {
          // 将pH值映射到0-100%的位置
          const position = Math.max(0, Math.min(100, phValue * (100 / 14)));
          phIndicator.style.left = `${position}%`;
        }

        // 更新温度
        function updateTemperature() {
          // 中和反应是放热反应
          const reactionIntensity = Math.min(acidAmount, baseAmount);
          temperature = 25 + reactionIntensity * 0.3;
          temperatureDisplay.textContent = `${temperature.toFixed(1)}°C`;
        }

        // 开始反应
        function startReaction() {
          reactionOccurring = true;
          statusDisplay.textContent = "反应中...";

          // 生成气泡
          generateBubbles();

          // 更新温度
          updateTemperature();

          // 显示反应结果
          showReactionResult("中和反应进行中！生成氯化钠和水");

          // 添加热量指示
          setTimeout(() => {
            showReactionResult("中和反应完成！生成氯化钠和水 (放热反应)");
          }, 2000);

          // 结束反应
          setTimeout(() => {
            reactionOccurring = false;
            statusDisplay.textContent = "实验中";
          }, 4000);
        }

        // 显示反应结果
        function showReactionResult(text) {
          reactionResult.textContent = text;
          reactionResult.style.opacity = "1";

          setTimeout(() => {
            reactionResult.style.opacity = "0";
          }, 3000);
        }

        // 生成气泡效果
        function generateBubbles() {
          bubblesContainer.innerHTML = "";

          for (let i = 0; i < 40; i++) {
            setTimeout(() => {
              const bubble = document.createElement("div");
              bubble.classList.add("bubble");

              // 随机位置和大小
              const size = Math.random() * 12 + 8;
              const left = Math.random() * 80 + 10;

              bubble.style.width = `${size}px`;
              bubble.style.height = `${size}px`;
              bubble.style.left = `${left}%`;
              bubble.style.bottom = "10px";

              // 随机动画时长
              const duration = Math.random() * 2 + 1;
              bubble.style.animationDuration = `${duration}s`;

              bubblesContainer.appendChild(bubble);

              // 动画结束后移除气泡
              setTimeout(() => {
                bubble.remove();
              }, duration * 1000);
            }, i * 100);
          }
        }

        // 更新混合物显示
        function updateMixtureDisplay() {
          if (acidAmount === 0 && baseAmount === 0 && waterAmount === 0) {
            mixtureDisplay.textContent = "无";
            return;
          }

          let mixtureText = "";
          if (acidAmount > 0) mixtureText += `盐酸 ${acidAmount}ml `;
          if (baseAmount > 0) mixtureText += `氢氧化钠 ${baseAmount}ml `;
          if (waterAmount > 0) mixtureText += `水 ${waterAmount}ml `;
          if (indicatorAdded) mixtureText += "+ 酚酞指示剂";

          mixtureDisplay.textContent = mixtureText;
        }

        // 重置实验
        function resetExperiment() {
          acidAmount = 0;
          baseAmount = 0;
          waterAmount = 0;
          indicatorAdded = false;
          experimentStarted = false;
          reactionOccurring = false;
          temperature = 25;

          beakerLiquid.style.height = "0%";
          beakerLiquid.style.background = "transparent";
          bubblesContainer.innerHTML = "";
          reactionResult.style.opacity = "0";

          statusDisplay.textContent = "准备中";
          mixtureDisplay.textContent = "无";
          volumeDisplay.textContent = "0ml";
          temperatureDisplay.textContent = "25.0°C";

          document.getElementById("start-btn").innerHTML =
            '<i class="fas fa-play"></i> 开始实验';
          document.getElementById("start-btn").style.background =
            "linear-gradient(to right, #4facfe, #00f2fe)";

          updatePhIndicator(7);
        }
      }

      // 鲁米诺发光实验逻辑
      {
        // DOM元素引用
        const luminolLiquid = document.getElementById("luminol-liquid");
        const bubblesContainer = document.getElementById("luminol-bubbles");
        const reactionResult = document.getElementById("luminol-result");
        const statusDisplay = document.getElementById("luminol-status");
        const mixtureDisplay = document.getElementById("luminol-mixture");
        const volumeDisplay = document.getElementById("luminol-volume");
        const glowIntensityDisplay = document.getElementById("glow-intensity");
        const glowEffect = document.getElementById("glow-effect");

        // 试剂按钮
        document
          .getElementById("luminol-start-btn")
          .addEventListener("click", startExperiment);
        document
          .getElementById("add-luminol")
          .addEventListener("click", () => addReagent("luminol"));
        document
          .getElementById("add-peroxide")
          .addEventListener("click", () => addReagent("peroxide"));
        document
          .getElementById("add-catalyst")
          .addEventListener("click", addCatalyst);
        document
          .getElementById("add-luminol-water")
          .addEventListener("click", () => addReagent("water"));
        document
          .getElementById("luminol-reset-btn")
          .addEventListener("click", resetExperiment);

        // 开始实验
        function startExperiment() {
          if (!experimentStarted) {
            experimentStarted = true;
            statusDisplay.textContent = "实验中";
            document.getElementById("luminol-start-btn").innerHTML =
              '<i class="fas fa-flask"></i> 实验中';
            document.getElementById("luminol-start-btn").style.background =
              "linear-gradient(to right, #00c853, #64dd17)";

            // 显示提示信息
            showReactionResult("鲁米诺实验开始！请添加试剂");
          }
        }

        // 添加试剂
        function addReagent(type) {
          if (!experimentStarted) {
            showReactionResult("请先点击'开始实验'按钮！");
            return;
          }

          if (reactionOccurring) return;

          // 更新液体量
          if (type === "luminol") luminolAmount += 10;
          if (type === "peroxide") peroxideAmount += 10;
          if (type === "water") waterLuminolAmount += 10;

          // 更新显示
          updateBeaker();
          updateMixtureDisplay();

          // 检查反应
          if (luminolAmount > 0 && peroxideAmount > 0 && catalystAdded) {
            startGlowReaction();
          }
        }

        // 添加催化剂
        function addCatalyst() {
          if (!experimentStarted) {
            showReactionResult("请先点击'开始实验'按钮！");
            return;
          }

          catalystAdded = true;
          updateMixtureDisplay();
          showReactionResult("已添加催化剂！现在可以开始发光反应");

          // 检查是否可以开始反应
          if (luminolAmount > 0 && peroxideAmount > 0) {
            startGlowReaction();
          }
        }

        // 更新烧杯显示
        function updateBeaker() {
          const totalVolume =
            luminolAmount + peroxideAmount + waterLuminolAmount;
          const liquidHeight = Math.min(100, totalVolume * 0.6);

          // 设置烧杯液体高度
          luminolLiquid.style.height = `${liquidHeight}%`;
          volumeDisplay.textContent = `${totalVolume}ml`;

          // 设置液体颜色
          let liquidColor = "#333333"; // 深色背景便于观察发光
          luminolLiquid.style.background = `linear-gradient(to top, ${liquidColor}, ${lightenColor(
            liquidColor
          )})`;
        }

        // 开始发光反应
        function startGlowReaction() {
          if (reactionOccurring) return;

          reactionOccurring = true;
          statusDisplay.textContent = "发光反应中";

          // 生成气泡
          generateBubbles();

          // 显示反应结果
          showReactionResult("发光反应开始！产生蓝色荧光");

          // 开始发光效果
          startGlowEffect();
        }

        // 发光效果
        function startGlowEffect() {
          // 清除之前的定时器
          if (glowTimer) clearInterval(glowTimer);

          glowIntensity = 100;
          updateGlowEffect();

          // 逐渐减弱发光效果
          glowTimer = setInterval(() => {
            glowIntensity -= 2;
            if (glowIntensity <= 0) {
              glowIntensity = 0;
              clearInterval(glowTimer);
              reactionOccurring = false;
              statusDisplay.textContent = "实验中";
            }
            updateGlowEffect();
          }, 200);
        }

        // 更新发光效果
        function updateGlowEffect() {
          glowEffect.style.opacity = (glowIntensity / 100) * 0.8;
          glowIntensityDisplay.textContent = `${glowIntensity}%`;
        }

        // 生成气泡效果
        function generateBubbles() {
          bubblesContainer.innerHTML = "";

          for (let i = 0; i < 30; i++) {
            setTimeout(() => {
              const bubble = document.createElement("div");
              bubble.classList.add("bubble");

              // 随机位置和大小
              const size = Math.random() * 10 + 5;
              const left = Math.random() * 80 + 10;

              bubble.style.width = `${size}px`;
              bubble.style.height = `${size}px`;
              bubble.style.left = `${left}%`;
              bubble.style.bottom = "10px";

              // 随机动画时长
              const duration = Math.random() * 2 + 1;
              bubble.style.animationDuration = `${duration}s`;

              bubblesContainer.appendChild(bubble);

              // 动画结束后移除气泡
              setTimeout(() => {
                bubble.remove();
              }, duration * 1000);
            }, i * 100);
          }
        }

        // 显示反应结果
        function showReactionResult(text) {
          reactionResult.textContent = text;
          reactionResult.style.opacity = "1";

          setTimeout(() => {
            reactionResult.style.opacity = "0";
          }, 3000);
        }

        // 更新混合物显示
        function updateMixtureDisplay() {
          if (
            luminolAmount === 0 &&
            peroxideAmount === 0 &&
            waterLuminolAmount === 0 &&
            !catalystAdded
          ) {
            mixtureDisplay.textContent = "无";
            return;
          }

          let mixtureText = "";
          if (luminolAmount > 0) mixtureText += `鲁米诺 ${luminolAmount}ml `;
          if (peroxideAmount > 0)
            mixtureText += `过氧化氢 ${peroxideAmount}ml `;
          if (waterLuminolAmount > 0)
            mixtureText += `水 ${waterLuminolAmount}ml `;
          if (catalystAdded) mixtureText += "+ 催化剂";

          mixtureDisplay.textContent = mixtureText;
        }

        // 重置实验
        function resetExperiment() {
          luminolAmount = 0;
          peroxideAmount = 0;
          waterLuminolAmount = 0;
          catalystAdded = false;
          experimentStarted = false;
          reactionOccurring = false;
          glowIntensity = 0;

          luminolLiquid.style.height = "0%";
          luminolLiquid.style.background = "transparent";
          bubblesContainer.innerHTML = "";
          reactionResult.style.opacity = "0";
          glowEffect.style.opacity = "0";

          statusDisplay.textContent = "准备中";
          mixtureDisplay.textContent = "无";
          volumeDisplay.textContent = "0ml";
          glowIntensityDisplay.textContent = "0%";

          document.getElementById("luminol-start-btn").innerHTML =
            '<i class="fas fa-play"></i> 开始实验';
          document.getElementById("luminol-start-btn").style.background =
            "linear-gradient(to right, #4facfe, #00f2fe)";

          if (glowTimer) {
            clearInterval(glowTimer);
            glowTimer = null;
          }
        }
      }

      // 辅助函数：加亮颜色
      function lightenColor(color) {
        return color.replace("52", "aa").replace("66", "aa");
      }

      // 辅助函数：稀释颜色
      function diluteColor(color, dilution) {
        return color; // 简化处理
      }

      // 复制链接到剪贴板
      document
        .getElementById("copy-link")
        .addEventListener("click", function (e) {
          e.preventDefault();
          const tempInput = document.createElement("input");
          tempInput.value = window.location.href;
          document.body.appendChild(tempInput);
          tempInput.select();
          document.execCommand("copy");
          document.body.removeChild(tempInput);

          // 显示提示
          const reactionResult =
            currentExperiment === "acid-base"
              ? document.getElementById("reaction-result")
              : document.getElementById("luminol-result");
          reactionResult.textContent = "链接已复制到剪贴板！";
          reactionResult.style.opacity = "1";

          setTimeout(() => {
            reactionResult.style.opacity = "0";
          }, 2000);
        });

      // 设置分享链接
      function setupShareLinks() {
        const pageUrl = encodeURIComponent(window.location.href);
        const twitterLinks = document.querySelectorAll(
          '.share-btn[href*="twitter.com"]'
        );
        const facebookLinks = document.querySelectorAll(
          '.share-btn[href*="facebook.com"]'
        );

        twitterLinks.forEach((link) => {
          link.href = `https://twitter.com/intent/tweet?text=来试试这个有趣的化学实验小游戏！&url=${pageUrl}`;
        });

        facebookLinks.forEach((link) => {
          link.href = `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`;
        });
      }

      // 初始化
      window.onload = function () {
        setupShareLinks();
      };
    </script>
  </body>
</html>
